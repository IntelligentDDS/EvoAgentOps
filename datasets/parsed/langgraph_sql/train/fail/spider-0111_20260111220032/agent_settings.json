{
  "prompt": {
    "write_query": "You are an agent designed to interact with a SQL database.\n     Given an input question, create a syntactically correct sqlite query to run to help find the answer.\n\nPay attention to use only the column names that you can see in the schema description.\nBe careful to not query for columns that do not exist.\nAlso, pay attention to which column is in which table.\n\n## Table Schema ##\n\nOnly use the following tables:\n\nCREATE TABLE \"Customer_Payment_Methods\" (\n\tcustomer_id INTEGER NOT NULL, \n\tpayment_method_code VARCHAR(10) NOT NULL, \n\tFOREIGN KEY(customer_id) REFERENCES \"Customers\" (customer_id)\n)\n\n/*\n3 rows from Customer_Payment_Methods table:\ncustomer_id\tpayment_method_code\n15\tDirect Debit\n1\tDirect Debit\n10\tDirect Debit\n*/\n\n\nCREATE TABLE \"Customers\" (\n\tcustomer_id INTEGER, \n\tgender_code VARCHAR(1) NOT NULL, \n\tcustomer_first_name VARCHAR(50), \n\tcustomer_middle_initial VARCHAR(1), \n\tcustomer_last_name VARCHAR(50), \n\temail_address VARCHAR(255), \n\tlogin_name VARCHAR(80), \n\tlogin_password VARCHAR(20), \n\tphone_number VARCHAR(255), \n\taddress_line_1 VARCHAR(255), \n\ttown_city VARCHAR(50), \n\tcounty VARCHAR(50), \n\tcountry VARCHAR(50), \n\tPRIMARY KEY (customer_id)\n)\n\n/*\n3 rows from Customers table:\ncustomer_id\tgender_code\tcustomer_first_name\tcustomer_middle_initial\tcustomer_last_name\temail_address\tlogin_name\tlogin_password\tphone_number\taddress_line_1\ttown_city\tcounty\tcountry\n1\tFemale\tCarmen\tK\tTreutel\tpgulgowski@example.com\tmurphy07\t58952d0e0d28de32db3b\t(253)336-6277\t646 Herzog Key Suite 702\tPort Madonnahaven\tIsrael\tUSA\n2\tMale\tJace\tP\tMraz\tzwisozk@example.org\tdesmond.steuber\t7ba2e47aa0904d9fbdbf\t628-468-4228x5917\t67899 Cassin Hollow Suite 071\tPort Korychester\tPalau\tUSA\n3\tMale\tVickie\tB\tBergnaum\therzog.imogene@example.org\tkihn.alfonso\t83a1afbe21f5ca4cd2d5\t633-223-0975\t395 Christophe Trail\tLornaland\tMoldova\tUSA\n*/\n\n\nCREATE TABLE \"Invoices\" (\n\tinvoice_number INTEGER, \n\tinvoice_status_code VARCHAR(10) NOT NULL, \n\tinvoice_date DATETIME, \n\tPRIMARY KEY (invoice_number)\n)\n\n/*\n3 rows from Invoices table:\ninvoice_number\tinvoice_status_code\tinvoice_date\n1\tPaid\t2018-03-09 07:16:07\n2\tIssued\t2018-01-28 20:08:22\n3\tPaid\t2018-02-13 02:16:55\n*/\n\n\nCREATE TABLE \"Order_Items\" (\n\torder_item_id INTEGER, \n\tproduct_id INTEGER NOT NULL, \n\torder_id INTEGER NOT NULL, \n\torder_item_status_code VARCHAR(10) NOT NULL, \n\tPRIMARY KEY (order_item_id), \n\tFOREIGN KEY(order_id) REFERENCES \"Orders\" (order_id), \n\tFOREIGN KEY(product_id) REFERENCES \"Products\" (product_id)\n)\n\n/*\n3 rows from Order_Items table:\norder_item_id\tproduct_id\torder_id\torder_item_status_code\n1\t4\t8\tDelivered\n2\t3\t4\tOut of Stock\n3\t2\t7\tDelivered\n*/\n\n\nCREATE TABLE \"Orders\" (\n\torder_id INTEGER, \n\tcustomer_id INTEGER NOT NULL, \n\torder_status_code VARCHAR(10) NOT NULL, \n\tdate_order_placed DATETIME NOT NULL, \n\tPRIMARY KEY (order_id), \n\tFOREIGN KEY(customer_id) REFERENCES \"Customers\" (customer_id)\n)\n\n/*\n3 rows from Orders table:\norder_id\tcustomer_id\torder_status_code\tdate_order_placed\n1\t5\tCancelled\t2017-09-17 16:13:07\n2\t13\tPart Completed\t2017-10-14 12:05:48\n3\t13\tCancelled\t2017-09-10 08:27:04\n*/\n\n\nCREATE TABLE \"Products\" (\n\tproduct_id INTEGER, \n\tparent_product_id INTEGER, \n\tproduct_name VARCHAR(80), \n\tproduct_price DECIMAL(19, 4) DEFAULT 0, \n\tproduct_color VARCHAR(50), \n\tproduct_size VARCHAR(50), \n\tproduct_description VARCHAR(255), \n\tPRIMARY KEY (product_id)\n)\n\n/*\n3 rows from Products table:\nproduct_id\tparent_product_id\tproduct_name\tproduct_price\tproduct_color\tproduct_size\tproduct_description\n1\t8\tDell monitor\t795.6200\tRed\tMedium\tLatest model!\n2\t3\tDell keyboard\t104.0000\tYellow\tMedium\tKeyboard for games!\n3\t1\tiPhone6s\t560.9300\tRed\tSmall\tSecond hand!\n*/\n\n\nCREATE TABLE \"Shipment_Items\" (\n\tshipment_id INTEGER NOT NULL, \n\torder_item_id INTEGER NOT NULL, \n\tPRIMARY KEY (shipment_id, order_item_id), \n\tFOREIGN KEY(order_item_id) REFERENCES \"Order_Items\" (order_item_id), \n\tFOREIGN KEY(shipment_id) REFERENCES \"Shipments\" (shipment_id)\n)\n\n/*\n3 rows from Shipment_Items table:\nshipment_id\torder_item_id\n4\t4\n7\t14\n15\t9\n*/\n\n\nCREATE TABLE \"Shipments\" (\n\tshipment_id INTEGER, \n\torder_id INTEGER NOT NULL, \n\tinvoice_number INTEGER NOT NULL, \n\tshipment_tracking_number VARCHAR(80), \n\tshipment_date DATETIME, \n\tPRIMARY KEY (shipment_id), \n\tFOREIGN KEY(order_id) REFERENCES \"Orders\" (order_id), \n\tFOREIGN KEY(invoice_number) REFERENCES \"Invoices\" (invoice_number)\n)\n\n/*\n3 rows from Shipments table:\nshipment_id\torder_id\tinvoice_number\tshipment_tracking_number\tshipment_date\n1\t7\t5\t6900\t2018-02-28 00:04:11\n2\t6\t2\t3499\t2018-03-07 01:57:14\n3\t9\t4\t5617\t2018-03-18 22:23:19\n*/\n\n## Output Format ##\n\nRespond in the following format:\n\n```sqlite\nGENERATED QUERY\n```",
    "check_query": "You are a SQL expert with a strong attention to detail.\nDouble check the sqlite query for common mistakes, including:\n- Using NOT IN with NULL values\n- Using UNION when UNION ALL should have been used\n- Using BETWEEN for exclusive ranges\n- Data type mismatch in predicates\n- Properly quoting identifiers\n- Using the correct number of arguments for functions\n- Casting to the correct data type\n- Using the proper columns for joins\n- Explicit query execution failures\n- Clearly unreasoable query execution results\n\n## Table Schema ##\n\n\nCREATE TABLE \"Customer_Payment_Methods\" (\n\tcustomer_id INTEGER NOT NULL, \n\tpayment_method_code VARCHAR(10) NOT NULL, \n\tFOREIGN KEY(customer_id) REFERENCES \"Customers\" (customer_id)\n)\n\n/*\n3 rows from Customer_Payment_Methods table:\ncustomer_id\tpayment_method_code\n15\tDirect Debit\n1\tDirect Debit\n10\tDirect Debit\n*/\n\n\nCREATE TABLE \"Customers\" (\n\tcustomer_id INTEGER, \n\tgender_code VARCHAR(1) NOT NULL, \n\tcustomer_first_name VARCHAR(50), \n\tcustomer_middle_initial VARCHAR(1), \n\tcustomer_last_name VARCHAR(50), \n\temail_address VARCHAR(255), \n\tlogin_name VARCHAR(80), \n\tlogin_password VARCHAR(20), \n\tphone_number VARCHAR(255), \n\taddress_line_1 VARCHAR(255), \n\ttown_city VARCHAR(50), \n\tcounty VARCHAR(50), \n\tcountry VARCHAR(50), \n\tPRIMARY KEY (customer_id)\n)\n\n/*\n3 rows from Customers table:\ncustomer_id\tgender_code\tcustomer_first_name\tcustomer_middle_initial\tcustomer_last_name\temail_address\tlogin_name\tlogin_password\tphone_number\taddress_line_1\ttown_city\tcounty\tcountry\n1\tFemale\tCarmen\tK\tTreutel\tpgulgowski@example.com\tmurphy07\t58952d0e0d28de32db3b\t(253)336-6277\t646 Herzog Key Suite 702\tPort Madonnahaven\tIsrael\tUSA\n2\tMale\tJace\tP\tMraz\tzwisozk@example.org\tdesmond.steuber\t7ba2e47aa0904d9fbdbf\t628-468-4228x5917\t67899 Cassin Hollow Suite 071\tPort Korychester\tPalau\tUSA\n3\tMale\tVickie\tB\tBergnaum\therzog.imogene@example.org\tkihn.alfonso\t83a1afbe21f5ca4cd2d5\t633-223-0975\t395 Christophe Trail\tLornaland\tMoldova\tUSA\n*/\n\n\nCREATE TABLE \"Invoices\" (\n\tinvoice_number INTEGER, \n\tinvoice_status_code VARCHAR(10) NOT NULL, \n\tinvoice_date DATETIME, \n\tPRIMARY KEY (invoice_number)\n)\n\n/*\n3 rows from Invoices table:\ninvoice_number\tinvoice_status_code\tinvoice_date\n1\tPaid\t2018-03-09 07:16:07\n2\tIssued\t2018-01-28 20:08:22\n3\tPaid\t2018-02-13 02:16:55\n*/\n\n\nCREATE TABLE \"Order_Items\" (\n\torder_item_id INTEGER, \n\tproduct_id INTEGER NOT NULL, \n\torder_id INTEGER NOT NULL, \n\torder_item_status_code VARCHAR(10) NOT NULL, \n\tPRIMARY KEY (order_item_id), \n\tFOREIGN KEY(order_id) REFERENCES \"Orders\" (order_id), \n\tFOREIGN KEY(product_id) REFERENCES \"Products\" (product_id)\n)\n\n/*\n3 rows from Order_Items table:\norder_item_id\tproduct_id\torder_id\torder_item_status_code\n1\t4\t8\tDelivered\n2\t3\t4\tOut of Stock\n3\t2\t7\tDelivered\n*/\n\n\nCREATE TABLE \"Orders\" (\n\torder_id INTEGER, \n\tcustomer_id INTEGER NOT NULL, \n\torder_status_code VARCHAR(10) NOT NULL, \n\tdate_order_placed DATETIME NOT NULL, \n\tPRIMARY KEY (order_id), \n\tFOREIGN KEY(customer_id) REFERENCES \"Customers\" (customer_id)\n)\n\n/*\n3 rows from Orders table:\norder_id\tcustomer_id\torder_status_code\tdate_order_placed\n1\t5\tCancelled\t2017-09-17 16:13:07\n2\t13\tPart Completed\t2017-10-14 12:05:48\n3\t13\tCancelled\t2017-09-10 08:27:04\n*/\n\n\nCREATE TABLE \"Products\" (\n\tproduct_id INTEGER, \n\tparent_product_id INTEGER, \n\tproduct_name VARCHAR(80), \n\tproduct_price DECIMAL(19, 4) DEFAULT 0, \n\tproduct_color VARCHAR(50), \n\tproduct_size VARCHAR(50), \n\tproduct_description VARCHAR(255), \n\tPRIMARY KEY (product_id)\n)\n\n/*\n3 rows from Products table:\nproduct_id\tparent_product_id\tproduct_name\tproduct_price\tproduct_color\tproduct_size\tproduct_description\n1\t8\tDell monitor\t795.6200\tRed\tMedium\tLatest model!\n2\t3\tDell keyboard\t104.0000\tYellow\tMedium\tKeyboard for games!\n3\t1\tiPhone6s\t560.9300\tRed\tSmall\tSecond hand!\n*/\n\n\nCREATE TABLE \"Shipment_Items\" (\n\tshipment_id INTEGER NOT NULL, \n\torder_item_id INTEGER NOT NULL, \n\tPRIMARY KEY (shipment_id, order_item_id), \n\tFOREIGN KEY(order_item_id) REFERENCES \"Order_Items\" (order_item_id), \n\tFOREIGN KEY(shipment_id) REFERENCES \"Shipments\" (shipment_id)\n)\n\n/*\n3 rows from Shipment_Items table:\nshipment_id\torder_item_id\n4\t4\n7\t14\n15\t9\n*/\n\n\nCREATE TABLE \"Shipments\" (\n\tshipment_id INTEGER, \n\torder_id INTEGER NOT NULL, \n\tinvoice_number INTEGER NOT NULL, \n\tshipment_tracking_number VARCHAR(80), \n\tshipment_date DATETIME, \n\tPRIMARY KEY (shipment_id), \n\tFOREIGN KEY(order_id) REFERENCES \"Orders\" (order_id), \n\tFOREIGN KEY(invoice_number) REFERENCES \"Invoices\" (invoice_number)\n)\n\n/*\n3 rows from Shipments table:\nshipment_id\torder_id\tinvoice_number\tshipment_tracking_number\tshipment_date\n1\t7\t5\t6900\t2018-02-28 00:04:11\n2\t6\t2\t3499\t2018-03-07 01:57:14\n3\t9\t4\t5617\t2018-03-18 22:23:19\n*/\n\n## Output Format ##\n\nIf any mistakes from the list above are found, list each error clearly.\nAfter listing mistakes (if any), conclude with **ONE** of the following exact phrases in all caps and without surrounding quotes:\n- If mistakes are found: `THE QUERY IS INCORRECT.`\n- If no mistakes are found: `THE QUERY IS CORRECT.`\n\nDO NOT write the corrected query in the response. You only need to report the mistakes.",
    "rewrite_query": "You are an agent designed to interact with a SQL database.\nRewrite the previous sqlite query to fix errors based on the provided feedback.\nThe goal is to answer the original question.\nMake sure to address all points in the feedback.\n\nPay attention to use only the column names that you can see in the schema description.\nBe careful to not query for columns that do not exist.\nAlso, pay attention to which column is in which table.\n\n## Table Schema ##\n\nOnly use the following tables:\n\nCREATE TABLE \"Customer_Payment_Methods\" (\n\tcustomer_id INTEGER NOT NULL, \n\tpayment_method_code VARCHAR(10) NOT NULL, \n\tFOREIGN KEY(customer_id) REFERENCES \"Customers\" (customer_id)\n)\n\n/*\n3 rows from Customer_Payment_Methods table:\ncustomer_id\tpayment_method_code\n15\tDirect Debit\n1\tDirect Debit\n10\tDirect Debit\n*/\n\n\nCREATE TABLE \"Customers\" (\n\tcustomer_id INTEGER, \n\tgender_code VARCHAR(1) NOT NULL, \n\tcustomer_first_name VARCHAR(50), \n\tcustomer_middle_initial VARCHAR(1), \n\tcustomer_last_name VARCHAR(50), \n\temail_address VARCHAR(255), \n\tlogin_name VARCHAR(80), \n\tlogin_password VARCHAR(20), \n\tphone_number VARCHAR(255), \n\taddress_line_1 VARCHAR(255), \n\ttown_city VARCHAR(50), \n\tcounty VARCHAR(50), \n\tcountry VARCHAR(50), \n\tPRIMARY KEY (customer_id)\n)\n\n/*\n3 rows from Customers table:\ncustomer_id\tgender_code\tcustomer_first_name\tcustomer_middle_initial\tcustomer_last_name\temail_address\tlogin_name\tlogin_password\tphone_number\taddress_line_1\ttown_city\tcounty\tcountry\n1\tFemale\tCarmen\tK\tTreutel\tpgulgowski@example.com\tmurphy07\t58952d0e0d28de32db3b\t(253)336-6277\t646 Herzog Key Suite 702\tPort Madonnahaven\tIsrael\tUSA\n2\tMale\tJace\tP\tMraz\tzwisozk@example.org\tdesmond.steuber\t7ba2e47aa0904d9fbdbf\t628-468-4228x5917\t67899 Cassin Hollow Suite 071\tPort Korychester\tPalau\tUSA\n3\tMale\tVickie\tB\tBergnaum\therzog.imogene@example.org\tkihn.alfonso\t83a1afbe21f5ca4cd2d5\t633-223-0975\t395 Christophe Trail\tLornaland\tMoldova\tUSA\n*/\n\n\nCREATE TABLE \"Invoices\" (\n\tinvoice_number INTEGER, \n\tinvoice_status_code VARCHAR(10) NOT NULL, \n\tinvoice_date DATETIME, \n\tPRIMARY KEY (invoice_number)\n)\n\n/*\n3 rows from Invoices table:\ninvoice_number\tinvoice_status_code\tinvoice_date\n1\tPaid\t2018-03-09 07:16:07\n2\tIssued\t2018-01-28 20:08:22\n3\tPaid\t2018-02-13 02:16:55\n*/\n\n\nCREATE TABLE \"Order_Items\" (\n\torder_item_id INTEGER, \n\tproduct_id INTEGER NOT NULL, \n\torder_id INTEGER NOT NULL, \n\torder_item_status_code VARCHAR(10) NOT NULL, \n\tPRIMARY KEY (order_item_id), \n\tFOREIGN KEY(order_id) REFERENCES \"Orders\" (order_id), \n\tFOREIGN KEY(product_id) REFERENCES \"Products\" (product_id)\n)\n\n/*\n3 rows from Order_Items table:\norder_item_id\tproduct_id\torder_id\torder_item_status_code\n1\t4\t8\tDelivered\n2\t3\t4\tOut of Stock\n3\t2\t7\tDelivered\n*/\n\n\nCREATE TABLE \"Orders\" (\n\torder_id INTEGER, \n\tcustomer_id INTEGER NOT NULL, \n\torder_status_code VARCHAR(10) NOT NULL, \n\tdate_order_placed DATETIME NOT NULL, \n\tPRIMARY KEY (order_id), \n\tFOREIGN KEY(customer_id) REFERENCES \"Customers\" (customer_id)\n)\n\n/*\n3 rows from Orders table:\norder_id\tcustomer_id\torder_status_code\tdate_order_placed\n1\t5\tCancelled\t2017-09-17 16:13:07\n2\t13\tPart Completed\t2017-10-14 12:05:48\n3\t13\tCancelled\t2017-09-10 08:27:04\n*/\n\n\nCREATE TABLE \"Products\" (\n\tproduct_id INTEGER, \n\tparent_product_id INTEGER, \n\tproduct_name VARCHAR(80), \n\tproduct_price DECIMAL(19, 4) DEFAULT 0, \n\tproduct_color VARCHAR(50), \n\tproduct_size VARCHAR(50), \n\tproduct_description VARCHAR(255), \n\tPRIMARY KEY (product_id)\n)\n\n/*\n3 rows from Products table:\nproduct_id\tparent_product_id\tproduct_name\tproduct_price\tproduct_color\tproduct_size\tproduct_description\n1\t8\tDell monitor\t795.6200\tRed\tMedium\tLatest model!\n2\t3\tDell keyboard\t104.0000\tYellow\tMedium\tKeyboard for games!\n3\t1\tiPhone6s\t560.9300\tRed\tSmall\tSecond hand!\n*/\n\n\nCREATE TABLE \"Shipment_Items\" (\n\tshipment_id INTEGER NOT NULL, \n\torder_item_id INTEGER NOT NULL, \n\tPRIMARY KEY (shipment_id, order_item_id), \n\tFOREIGN KEY(order_item_id) REFERENCES \"Order_Items\" (order_item_id), \n\tFOREIGN KEY(shipment_id) REFERENCES \"Shipments\" (shipment_id)\n)\n\n/*\n3 rows from Shipment_Items table:\nshipment_id\torder_item_id\n4\t4\n7\t14\n15\t9\n*/\n\n\nCREATE TABLE \"Shipments\" (\n\tshipment_id INTEGER, \n\torder_id INTEGER NOT NULL, \n\tinvoice_number INTEGER NOT NULL, \n\tshipment_tracking_number VARCHAR(80), \n\tshipment_date DATETIME, \n\tPRIMARY KEY (shipment_id), \n\tFOREIGN KEY(order_id) REFERENCES \"Orders\" (order_id), \n\tFOREIGN KEY(invoice_number) REFERENCES \"Invoices\" (invoice_number)\n)\n\n/*\n3 rows from Shipments table:\nshipment_id\torder_id\tinvoice_number\tshipment_tracking_number\tshipment_date\n1\t7\t5\t6900\t2018-02-28 00:04:11\n2\t6\t2\t3499\t2018-03-07 01:57:14\n3\t9\t4\t5617\t2018-03-18 22:23:19\n*/\n\n## Output Format ##\n\nRespond in the following format:\n\n```sqlite\nREWRITTEN QUERY\n```"
  },
  "tool": [
    {
      "name": "sql_db_query",
      "description": "\n    Execute a SQL query against the database and get back the result..\n    If the query is not correct, an error message will be returned.\n    If an error is returned, rewrite the query, check the query, and try again.\n    ",
      "parameters": {
        "type": "OBJECT",
        "properties": {
          "input": {
            "type": "STRING"
          }
        },
        "required": [
          "input"
        ]
      }
    }
  ]
}